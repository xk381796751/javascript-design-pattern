<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>状态模式3.0</title>
</head>

<body>



	<script>
		// 美式咖啡态(american)： 只吐黑咖啡
		// 普通拿铁态(latte)： 黑咖啡加点奶
		// 香草拿铁态(vanillaLatte)： 黑咖啡加点奶再加香草糖浆
		// 摩卡咖啡态(mocha)：黑咖啡加点奶再加点巧克力

		class CoffeeMaker {
			constructor() {
				this.state = 'init';
				// 初始化牛奶的存储量
				this.leftMilk = '500ml';
			}
			stateToProcessor = {
				that: this,
				american() {
					// 尝试在行为函数里拿到咖啡机实例的信息并输出
					console.log('咖啡机现在的牛奶存储量是:', this.that.leftMilk)
					console.log('我只吐黑咖啡');
				},
				latte() {
					this.american()
					console.log('加点奶');
				},
				vanillaLatte() {
					this.latte();
					console.log('再加香草糖浆');
				},
				mocha() {
					this.latte();
					console.log('再加巧克力');
				}
			}

			// 关注咖啡机状态切换函数
			changeState(state) {
				this.state = state;
				if (!this.stateToProcessor[state]) {
					return;
				}
				this.stateToProcessor[state]();
			}
		}

		const mk = new CoffeeMaker();
		mk.changeState('mocha');
	</script>
</body>

</html>